# PVZ

# 2 этап отбора AVITO

# Варианты запуска

# Сборка и запуск контейнера

- Через docker-compose
```bash
docker-compose up -d --build
```
- Через Makefile
```bash
make up
```
Также через Makefile
- Остановить контейнер
```bash
make stop
```
- удалить образы
```bash
make prune
```
- Посмотреть работающие контейнеры (и их состояние)
```bash
make ps
```
- Посмотреть логи всех контейнеров
```bash
make logs-all
```
- logs
```bash
makw logs <<вставить название контейнера>>
```

Cервис выдержит небольшую нагрузку (не успел прикрутить балансировщик нагрузки). Можно сделать либо кастомную или через Nginx и Docker

# Способы опробовать систему
- Посмотреть Swagger UI с локальногоо хоста: http://0.0.0.0:8080/docs, с машины где запущен докео: http://{ip вашего сервера}/docs
- Посмотреть содержимое баз данных: http://0.0.0.0:7777/, почта та которую укажете в ADMIN_EMAIL, пароль - ADMIN_PASSWORD в .env файле (пример .env файла можете посмотреть .env.example)
- Посмотреть prometheus с метриками http://0.0.0.0:9000/metrics
- Порт для grpc: http://0.0.0.0:3000
- Запустить интеграционные тесты в скрипте
```bash
python
```
- Запустить нагрузочные тесты
```bash
export $(grep -v '^#' .env | xargs) && locust -f source/load_test/locustfile.py --host=http://localhost:$PORT
```

## Для личной проверки
- Аккаунт админа создаётся автоматически логин: admin пароль: 12345, после авторизации можно будет получить администраторский токен доступа
- Аккаунт пользователя надо зарегастрировать через /signup после чего можно будет получить пользовательский токен доступа
